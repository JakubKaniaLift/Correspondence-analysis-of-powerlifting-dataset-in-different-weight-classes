![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/df99d033-b2fa-4bcd-aa5b-b80e9094ebf0)# Correspondence analysis of powerlifting dataset in different weight classes

## Libraries

```r
library("MASS")
library("ca")
library("RColorBrewer")
library("tidyverse")
library("dplyr")
library("ggplot2")
```
## Data

Dataset have:

* 16 columns
* 41,152 rows

Columns are:
1. name <- name of participants
2. sex 
3. event <- B (bench), SB (squat, bench), SBD (squat, bench, deadlift)
4. equipment <- used equipment in event
5. age 
6. qge_class
7. division
8. bodyweight_kg
9. weight_class_kg
10. best3squat_kg <- best squat out of 3
11. best3bench_kg <- best bench out of 3
12. best3deadlift_kg <- best DL out of 3
13. place
14. date
15. federation
16. meet_name <- in what event the data was taken

### Loading data
```r
lifts <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-08/ipf_lifts.csv")
lifts <- lifts[lifts$place != 'DQ',]
lifts
```
![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/e48ec4a2-08ba-4649-afcb-df11f14e6612)

### Cleaning data

We are going to compare only full SBD lifts, that ended qualified and took place at "World Masters Powerlifting Championships".
```r
lifts <- lifts[lifts$event == 'SBD',]
lifts <- lifts[lifts$place != 'DQ',]
lifts <- lifts[lifts$meet_name == 'World Masters Powerlifting Championships',]
```
![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/f235759e-5d86-41d2-88d4-04d6b093e121)

This way we end up with 5,591 rows.

#### Searching and cleaning NAs

```r
#Checking NAs
sapply(lifts, function(x) sum(is.na(x)))
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/b14b6d4f-348b-4bd5-94b3-b4674273f511)

```r
#Removing NAs
lifts <- lifts %>% drop_na(best3squat_kg)
lifts <- lifts %>% drop_na(best3bench_kg)
lifts <- lifts %>% drop_na(best3deadlift_kg)
lifts <- lifts %>% drop_na(bodyweight_kg)

sapply(lifts, function(x) sum(is.na(x)))
```
![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/1b10b4ee-cb68-49fe-bee3-f886cb0ac284)

We cleaned data from NAs that appeared in our lifts and we cleane Nas in bodyweight for the future.

### Exploring and changing data

#### Data sets

We divide our data set by 'sex' parameter, because our analysis will be done around lifts done by female and men.

```r
lifts_m <- lifts[lifts$sex=='M',]
lifts_f <- lifts[lifts$sex=='F',]
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/058dcaf8-959b-4d53-be2e-a1761f819030)

#### Counting the amount of competitors in every weight class

##### Men:

```r
sort(table(lifts_m$weight_class_kg))
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/c98cd6a9-a985-4f4c-9ac5-203fc7f23cb7)

##### Female:

```r
sort(table(lifts_f$weight_class_kg))
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/af8f61e3-4ea3-4649-8754-654e25f215d2)

#### Columns

We are picking only columns that will be used in our analysis:
* name
* bodyweight_kg
* weight_class_kg
* best3squat_kg <- best squat out of 3
* best3bench_kg <- best bench out of 3
* best3deadlift_kg <- best DL out of 3
* date

##### Men:
```r
lifts_m <- lifts_m[,c(1,8,9,10,11,12,14)]
colnames(lifts_m) <- c('Name','Bodyweight','Weight_class','Squat','Bench','DL','Date')
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/84c309ad-8e2f-4e7b-b36a-2613234d67be)

##### Female:

```r
lifts_f <- lifts_f[,c(1,8,9,10,11,12,14)]
colnames(lifts_f) <- c('Name','Bodyweight','Weight_class','Squat','Bench','DL','Date')
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/0f4ee78e-e390-40d8-ab7d-1f01a64700f4)

## Wilks coefficient

The Wilks coefficient, also known as the Wilks score or Wilks formula, is a calculation used in powerlifting to compare the strength levels of lifters across different weight classes.

$Coeff = \frac{500}{a + bx + cx^2 + dx^3 + ex^4 + fx^5}$

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/82d89d6b-fb50-4808-b47f-ab89cff1b3e5)

We will calculate Wilks coefficient for all participants.

### Men - Wilks

```r
#Vector of coefficients
a_men <- c(47.46178854,
           8.472061379,
           0.07369410346,
           -0.001395833811,
           7.07665973070743e-6,
           -1.20804336482315e-8)

#Function
wilks_men <- function(total, bodyweight) {
  coefficient <- a_men[1]
  for (i in 2:length(a_men)) {
    coefficient <- coefficient + (a_men[i] * (bodyweight ^ (i-1)))
  }
  600 / coefficient
}
```

#### LOOP

```r
for (i in 1:nrow(lifts_m)){
  lifts_m$Wilks[i] <- wilks_men(sum(lifts_m[i,c(4,5,6)]),as.numeric(lifts_m$Bodyweight)) * sum(lifts_m[i,c(4,5,6)])
}

head(lifts_m,10)
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/6c0bde64-0cef-4027-b9a8-bcb57f6a5033)

### Female - Wilks

```r
a_female <- c(-125.4255398,
              13.71219419,
              -0.03307250631,
              -0.001050400051,
              9.38773881462799e-6,
              -2.3334613884954e-8)

#Function
wilks_female <- function(total, bodyweight) {
  coefficient <- a_female[1]
  for (i in 2:length(a_female)) {
    coefficient <- coefficient + (a_female[i] * (bodyweight ^ (i-1)))
  }
  600 / coefficient
}
```

#### LOOP

```r
for (i in 1:nrow(lifts_f)){
  lifts_f$Wilks[i] <- wilks_female(sum(lifts_f[i,c(4,5,6)]),as.numeric(lifts_f$Bodyweight)) * sum(lifts_f[i,c(4,5,6)])
}

head(lifts_f,10)
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/b404e000-9054-4e39-9a52-147e80ac0c9b)

## Correspondence analysis

### Picking the best participants over years in each weight class

#### Men

```r
men_best <- lifts_m %>% 
  group_by(Weight_class) %>%
  filter(Wilks == max(Wilks))

men_best <- men_best %>% arrange(Name,Date)
print(men_best,n = nrow(men_best))
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/0755d618-15e8-480d-97a1-6f2d48843dbd)

##### Removing duplicates

```r
men_best <- men_best[c(-3,-10),]
men_best
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/9542c9c1-7dc4-4572-96a7-99f4b59d8b3c)


#### Female

```r
female_best <- lifts_f %>% 
  group_by(Weight_class) %>%
  filter(Wilks == max(Wilks))

female_best <- female_best %>% arrange(Name,Date)
print(female_best,n = nrow(female_best))
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/66992d60-f7f6-425b-a3bb-a526650d5770)

### Heatmaps

Heatmaps are a method of representing data graphically where values are depicted by color, making it easy to visualize complex data and understand it at a glance.

To make heatmaps we need our data to be a matrix.

```r
men_best_m <- as.matrix(men_best[1:nrow(men_best),as.numeric(c(4,5,6))])
female_best_m <- as.matrix(female_best[1:nrow(female_best),as.numeric(c(4,5,6))])
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/0adac990-0228-4753-8dd5-d20ab2bc6a22) | ![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/f7f4981b-258f-4bde-a8c4-750b7744f649)

To make sure our values are indeoendent, we are going to do $X^2$ test.

```r
chisq.test(men_best_m)
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/c32e72ea-0d6f-467f-8788-84e0a1d5f018)

```r
chisq.test(female_best_m)
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/8daa98d9-6d71-43b3-9afe-fcf44a0585a7)

Now we will count Pearson's residuals and make heatmaps from them.

```r
P = men_best_m/sum(men_best_m)
PP = outer(rowSums(P),colSums(P))
E = (P-PP)/sqrt(PP)
head(E)
```

```r
P = female_best_m/sum(female_best_m)
PP = outer(rowSums(P),colSums(P))
E = (P-PP)/sqrt(PP)
head(E)
```

![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/072dbade-6c8a-494f-bca0-22006df4d404) | ![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/d541690f-54cd-4b41-9da3-19cf6d176804)

Finally we will make heatmaps

```r
heatmap(E,scale="none",Colv=NA,col= brewer.pal(8,"Blues"))

```

Men             |  Female
:-------------------------:|:-------------------------:
![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/2e349bca-5742-4917-9665-b5960c1a5ab4)  |  ![image](https://github.com/JakubKaniaLift/Correspondence-analysis-of-powerlifting-dataset-in-different-weight-classes/assets/138041287/65f0e59b-ad40-469e-8bae-07c39f884ecb)

Received heatmaps presents performance across different weight classes and lifts by using color intensity to indicate the relative strength levels achieved by lifters in each specific combination.


















